
original_dir=$(pwd)
cd ../
for dir in demo_apk; do
  echo "Entering $dir"
  cd $dir
  find `pwd` -type f -name "*.apk" | xargs -n 1 ../extract_apk.sh
  cat valid_apks.txt | sort | uniq > valid_apks_tmp.txt
  cat malformed_xml.txt | sort | uniq > malformed_xml_tmp.txt
  cat malformed_dex.txt | sort | uniq > malformed_dex_tmp.txt
  cp valid_apks_tmp.txt valid_apks.txt 2>/dev/null
  cp malformed_xml_tmp.txt malformed_xml.txt 2>/dev/null
  cp malformed_dex_tmp.txt malformed_dex.txt 2>/dev/null
  rm -f valid_apks_tmp.txt malformed_xml_tmp.txt malformed_dex_tmp.txt
  cd $original_dir
done
